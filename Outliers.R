####################################################################################3
###########################                                 #########################
###########################   OUTLIER DETECTION & REMOVAL   #########################
###########################                                 #########################
#####################################################################################

library(outliers)


rm.out<-function(data){
  
  n<-length(data)
  p_val = 0.049
  
  while(p_val<0.05){
  t<-cochran.test(data, rep(1:n,1))  # Test for outliers
  p_val<-t$p.value
  
  if(p_val<0.05){  data<-rm.outlier(data, fill = T, median = T ) }
  
  }
  return(data)
  
}

